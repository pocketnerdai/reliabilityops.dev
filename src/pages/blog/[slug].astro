---
import { client } from '../../sanity/lib/client';
import { postBySlugQuery } from '../../sanity/lib/queries';

const { slug } = Astro.params;
const post = await client.fetch(postBySlugQuery, { slug });

if (!post) {
  return Astro.redirect('/404');
}
---

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{post.title}</title>
</head>
<body style="background: #0f172a; color: white; padding: 2rem;">
  <h1>Debug: {post.title}</h1>
  
  <div style="background: #1e293b; padding: 1rem; margin: 1rem 0;">
    <h2>Test 1: Static Content</h2>
    <p>If you can see this text, the page is rendering.</p>
  </div>
  
  <div style="background: #1e293b; padding: 1rem; margin: 1rem 0;">
    <h2>Test 2: Post Data</h2>
    <p>Title: {post.title}</p>
    <p>Has body: {post.body ? 'Yes' : 'No'}</p>
  </div>
  
  <div style="background: #1e293b; padding: 1rem; margin: 1rem 0;">
    <h2>Test 3: Body Content</h2>
    <pre>{JSON.stringify(post.body?.[0], null, 2)}</pre>
  </div>
</body>
</html>